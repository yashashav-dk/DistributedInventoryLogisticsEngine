#!/bin/sh
# Maven Wrapper script â€” downloads Maven if not present, then delegates.
# See https://maven.apache.org/wrapper/

set -e

MAVEN_PROJECTBASEDIR="${MAVEN_BASEDIR:-$(cd "$(dirname "$0")" && pwd)}"
MAVEN_WRAPPER_PROPERTIES="$MAVEN_PROJECTBASEDIR/.mvn/wrapper/maven-wrapper.properties"

if [ -f "$MAVEN_WRAPPER_PROPERTIES" ]; then
  MAVEN_URL=$(grep 'distributionUrl' "$MAVEN_WRAPPER_PROPERTIES" | cut -d'=' -f2-)
fi

MAVEN_HOME="$HOME/.m2/wrapper/dists/apache-maven-3.9.6"

if [ ! -d "$MAVEN_HOME" ]; then
  echo "Downloading Maven 3.9.6..."
  mkdir -p "$MAVEN_HOME"
  curl -fsSL "$MAVEN_URL" -o /tmp/maven.zip
  unzip -qo /tmp/maven.zip -d "$MAVEN_HOME"
  rm /tmp/maven.zip
fi

MAVEN_BIN=$(find "$MAVEN_HOME" -name mvn -type f | head -1)
exec "$MAVEN_BIN" "$@"
